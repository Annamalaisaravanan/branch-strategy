name: CI/CD 

on:
  push:
    branches:
      - features
      - releases
  pull_request:
    branches:
      - '*'

jobs:

  Development:
      if: startsWith(github.ref, 'refs/heads/features')
      runs-on: ubuntu-latest
      env:
          DATABRICKS_HOST: ${{ secrets.DB_HOST_DEV }}
          DATABRICKS_TOKEN:  ${{ secrets.DB_TOKEN_DEV }}
          AWS_ACCESS_KEY: ${{ secrets.C5I_ACCESS_KEY }}
          AWS_SECRET_KEY: ${{ secrets.C5I_SECRET_KEY }}

      steps:
          - name: Checkout Repository
            uses: actions/checkout@v2

          - name: Build
            run: |
              # Add your build commands here
              echo "Building..."


  Staging:
      if: always() && startsWith(github.ref, 'refs/heads/releases')
      runs-on: ubuntu-latest
      needs: Development
      env:
          DATABRICKS_HOST: ${{ secrets.DB_HOST_STAG }}
          DATABRICKS_TOKEN:  ${{ secrets.DB_TOKEN_STAG }}
          AWS_ACCESS_KEY: ${{ secrets.C5I_ACCESS_KEY }}
          AWS_SECRET_KEY: ${{ secrets.C5I_SECRET_KEY }}
      steps:
          - name: Checkout Repository
            uses: actions/checkout@v2
            
          - name: Acceptance
            run: |
              # Add your acceptance testing commands here
              echo "Acceptance testing..."
  
  Production:
      if: always() && startsWith(github.ref, 'refs/heads/releases')
      runs-on: ubuntu-latest
      needs: Staging
      env:
          DATABRICKS_HOST: ${{ secrets.DB_HOST_PROD }}
          DATABRICKS_TOKEN:  ${{ secrets.DB_TOKEN_PROD }}
          AWS_ACCESS_KEY: ${{ secrets.C5I_ACCESS_KEY }}
          AWS_SECRET_KEY: ${{ secrets.C5I_SECRET_KEY }}
      steps:
          - name: Checkout Repository
            uses: actions/checkout@v2
            
          - name: Production
            if: startsWith(github.ref, 'refs/heads/releases')
            run: |
              # Add your production deployment commands here
              echo "Deploying to Production..."
  

           

  


 